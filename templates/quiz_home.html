<!-- Picklist of what you want to learn about -->
{% extends 'base.html' %}

{% block body %}
<br>
<br>
<div class="container-fluid">
    <div class="row">
    <div class="col-xs-12 col-md-9 col-lg-9">
        <h3>What do you want to learn about?</h3>
        <br>
        <br>
        <div>
          <form action="/country">
              <button type="submit" class="btn btn-default">Countries!</button>
          </form>
        </div>
        <div>
          <form action="/continent">
              <button type="submit" class="btn btn-default">Continents!</button>
          </form>
        </div>
    </div>
    </div>
</div>

    <style type="text/css">
      html, body { height: 100%; margin: 0; padding: 0; }
      #map { height: 90%; }
    </style>

<!-- Continents Map -->
  <div class="col-xs-12 col-s-8 col-s-offset-2 col-md-10 col-md-offset-1 col-lg-8 col-lg-offset-2">
       <div id="map-canvas"></div> 
  </div>

<!-- Map Styling and Javascript Goes Here -->
  <style type="text/css">
      #map-canvas {
        height: 600px;
      }
    </style>

    <script type="text/javascript" src="https://maps.google.com/maps/api/js?sensor=false"></script>


    <script type="text/javascript">
      var colors = ['#990000', '#ff6600', '#660033', '#993300'];
      var map;

      function initialize() {
        var myOptions = {
          zoom: 2,
          center: new google.maps.LatLng(14.7146287, 7.8468339),
          mapTypeId: google.maps.MapTypeId.SATELLITE,
          disableDefaultUI: true,
          streetViewControl: false,
          navigationControl: false,
          mapTypeControl: false,
          scaleControl: false,
          disableDoubleClickZoom: true,
          draggable: false,
          panControl: false,
          zoomControl: false
        };

        map = new google.maps.Map(document.getElementById('map-canvas'),
            myOptions);

        // Initialize JSONP request
        var script = document.createElement('script');
        var url = ['https://www.googleapis.com/fusiontables/v1/query?'];
        url.push('sql=');
        var query = 'SELECT * FROM ' +
            'AIzaSyAqdoBXhy4GVe3YCNExyClPO2KwD1yIfA4';
        var encodedQuery = encodeURIComponent(query);
        url.push(encodedQuery);
        url.push('&callback=drawMap');
        url.push('&key=1n59-Sd9piJiAk5-R80R-uwHKWl2uz-TSYv0gi64P');
        script.src = url.join('');
        var body = document.getElementsByTagName('body')[0];
        body.appendChild(script);
        console.log(script);

        console.log(query);
      }

      function drawMap(data) {
        var rows = data['rows'];
        for (var i in rows) {
          if (rows[i][0] != 'Antarctica') {
            var newCoordinates = [];
            var geometries = rows[i][1]['geometries'];
            if (geometries) {
              for (var j in geometries) {
                newCoordinates.push(constructNewCoordinates(geometries[j]));
              }
            } else {
              newCoordinates = constructNewCoordinates(rows[i][1]['geometry']);
            }
            var randomnumber = Math.floor(Math.random() * 4);
            var country = new google.maps.Polygon({
              paths: newCoordinates,
              strokeColor: colors[randomnumber],
              strokeOpacity: 0,
              strokeWeight: 1,
              fillColor: colors[randomnumber],
              fillOpacity: 0.3
            });
            google.maps.event.addListener(country, 'mouseover', function() {
              this.setOptions({fillOpacity: 1});
            });
            google.maps.event.addListener(country, 'mouseout', function() {
              this.setOptions({fillOpacity: 0.3});
            });

            country.setMap(map);
          }
        }
      }

      function constructNewCoordinates(polygon) {
        var newCoordinates = [];
        var coordinates = polygon['coordinates'][0];
        for (var i in coordinates) {
          newCoordinates.push(
              new google.maps.LatLng(coordinates[i][1], coordinates[i][0]));
        }
        return newCoordinates;
      }

      google.maps.event.addDomListener(window, 'load', initialize);
    </script>

<script src="https://www.googleapis.com/fusiontables/v1/query?sql=SELECT%20*%20FROM%20AIzaSyAqdoBXhy4GVe3YCNExyClPO2KwD1yIfA4&amp;callback=drawMap&amp;key=1n59-Sd9piJiAk5-R80R-uwHKWl2uz-TSYv0gi64P"></script>



{% endblock %}